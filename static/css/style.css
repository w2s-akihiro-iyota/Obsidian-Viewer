:root {
    --bg-primary: #1e1e1e;
    --bg-secondary: #252526;
    --text-normal: #dcddde;
    --text-muted: #858585;
    --accent-purple: #7b61ff;
    --border-color: #333;
    --header-height: 50px;
    --font-family: 'Consolas', "Noto Sans JP", "BIZ UDPGothic", "Meiryo UI", 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    --code-font: 'Consolas', 'Monaco', 'Courier New', monospace;
}

/* Light Theme */
:root[data-theme="light"] {
    --bg-primary: #ffffff;
    --bg-secondary: #f5f5f5;
    --text-normal: #2e3338;
    --text-muted: #717171;
    --accent-purple: #7b61ff;
    --border-color: #e0e0e0;
}

* {
    box-sizing: border-box;
}

body {
    background-color: var(--bg-primary);
    color: var(--text-normal);
    font-family: var(--font-family);
    margin: 0;
    padding: 0;
    line-height: 1.6;
    transition: background-color 0.3s ease, color 0.3s ease;
}

a {
    color: var(--accent-purple);
    text-decoration: none;
}

a:hover {
    text-decoration: underline;
}

/* Layout */
.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

.container-wide {
    max-width: 1400px;
    /* Wider layout for file view */
    margin: 0 auto;
    padding: 20px;
}

header {
    background-color: var(--bg-secondary);
    border-bottom: 1px solid var(--border-color);
    padding: 10px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    position: sticky;
    top: 0;
    z-index: 100;
}

.header-actions {
    display: flex;
    align-items: center;
    gap: 16px;
}

.theme-toggle-btn {
    background: transparent;
    border: 1px solid var(--border-color);
    padding: 8px;
    border-radius: 6px;
    color: var(--text-normal);
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
}

.theme-toggle-btn:hover {
    background-color: var(--bg-primary);
    border-color: var(--accent-purple);
}

.theme-toggle-btn .sun-icon {
    display: none;
}

.theme-toggle-btn .moon-icon {
    display: block;
}

:root[data-theme="light"] .theme-toggle-btn .sun-icon {
    display: block;
}

:root[data-theme="light"] .theme-toggle-btn .moon-icon {
    display: none;
}

.brand {
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: 12px;
    text-decoration: none;
    transition: opacity 0.2s;
}

.brand:hover {
    opacity: 0.8;
    text-decoration: none;
}

.brand-logo {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
    flex-shrink: 0;
}

.brand-text {
    display: flex;
    flex-direction: column;
    align-items: center;
    line-height: 1.2;
}

.brand-line {
    color: var(--text-normal);
    font-size: 1.2rem;
    font-weight: 600;
}

/* Search */
.search-container {
    position: relative;
    width: 300px;
}

#search-input {
    width: 100%;
    padding: 6px 12px;
    border-radius: 4px;
    border: 1px solid var(--border-color);
    background-color: var(--bg-primary);
    color: var(--text-normal);
    font-family: var(--font-family);
}

#search-input:focus {
    outline: none;
    border-color: var(--accent-purple);
}

.search-results {
    position: absolute;
    top: 100%;
    left: 0;
    width: 100%;
    background-color: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    margin-top: 4px;
    max-height: 300px;
    overflow-y: auto;
    z-index: 1000;
    display: none;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
}

.search-result-item {
    display: block;
    padding: 8px 12px;
    color: var(--text-normal);
    text-decoration: none;
    border-bottom: 1px solid var(--border-color);
}

.search-result-item:last-child {
    border-bottom: none;
}

.search-result-item:hover {
    background-color: var(--accent-purple);
    color: white;
    text-decoration: none;
}

.search-result-empty {
    padding: 8px 12px;
    color: var(--text-muted);
    font-size: 0.9em;
}

/* Index Header & View Toggle */
.index-header-top {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
}

.view-toggle {
    display: flex;
    gap: 4px;
    background-color: var(--bg-secondary);
    border-radius: 6px;
    padding: 4px;
    border: 1px solid var(--border-color);
}

.view-toggle-btn {
    background: transparent;
    border: none;
    padding: 6px 10px;
    border-radius: 4px;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
}

.view-toggle-btn:hover {
    background-color: var(--bg-primary);
    color: var(--text-normal);
}

.view-toggle-btn.active {
    background-color: var(--accent-purple);
    color: white;
}

/* File List (Index) */
.file-list {
    list-style: none;
    padding: 0;
}

.file-item {
    background-color: rgba(0, 0, 0, 0.4);
    border: 1px solid rgba(123, 97, 255, 0.35);
    border-radius: 12px;
    margin-bottom: 12px;
    overflow: hidden;
    transition: all 0.3s ease;
    box-shadow: 0 0 12px rgba(123, 97, 255, 0.15);
}

.file-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 0 25px rgba(123, 97, 255, 0.45), 0 4px 16px rgba(0, 0, 0, 0.4);
    border-color: rgba(123, 97, 255, 0.65);
}

.file-link {
    display: flex;
    gap: 16px;
    padding: 16px;
    color: inherit;
    text-decoration: none;
    min-height: 160px;
}

.file-preview {
    flex-shrink: 0;
    width: 240px;
    height: 120px;
    border-radius: 12px;
    overflow: hidden;
    background: linear-gradient(to bottom right, #5940c4, #7b61ff, #8a73ff);
    padding: 16px;
    display: flex;
    align-items: flex-start;
    box-shadow: 0 0 25px rgba(123, 97, 255, 0.6), inset 0 0 25px rgba(255, 255, 255, 0.08);
    border: 1px solid rgba(150, 120, 255, 0.3);
}

.file-preview p {
    margin: 0;
    font-size: 0.8rem;
    line-height: 1.5;
    color: rgba(255, 255, 255, 0.95);
    overflow: hidden;
    display: -webkit-box;
    -webkit-line-clamp: 6;
    line-clamp: 6;
    -webkit-box-orient: vertical;
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.25);
}

.file-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 8px;
    min-width: 0;
}

.file-name {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--text-normal);
    margin-bottom: 8px;
}

.file-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-bottom: 8px;
}

.file-tag {
    background: linear-gradient(135deg, #5940c4, #7055db);
    color: white;
    padding: 5px 14px;
    border-radius: 14px;
    font-size: 0.8rem;
    font-weight: 600;
    border: 1px solid rgba(131, 102, 230, 0.6);
    box-shadow: 0 0 12px rgba(107, 82, 217, 0.7), inset 0 0 10px rgba(255, 255, 255, 0.1);
    transition: all 0.2s ease;
}

.file-tag:hover {
    box-shadow: 0 0 18px rgba(107, 82, 217, 0.9), inset 0 0 15px rgba(255, 255, 255, 0.15);
    transform: scale(1.05);
}

.file-meta {
    display: flex;
    flex-direction: column;
    gap: 4px;
    font-size: 0.85rem;
    color: var(--text-muted);
}



.file-updated {
    color: var(--text-muted);
    font-size: 0.8rem;
}

/* Grid View */
.file-list.grid-view {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 16px;
}

.file-list.grid-view .file-item {
    margin-bottom: 0;
}

.file-list.grid-view .file-link {
    flex-direction: column;
    gap: 12px;
    min-height: 280px;
}

.file-list.grid-view .file-preview {
    width: 100%;
    height: 140px;
    box-shadow: 0 0 30px rgba(123, 97, 255, 0.7), inset 0 0 25px rgba(255, 255, 255, 0.08);
}

.file-list.grid-view .file-preview p {
    -webkit-line-clamp: 6;
    line-clamp: 6;
}

/* Responsive grid: 2 columns on medium screens */
@media (max-width: 1024px) {
    .file-list.grid-view {
        grid-template-columns: repeat(2, 1fr);
    }
}

/* Responsive grid: 1 column on small screens */
@media (max-width: 640px) {
    .file-list.grid-view {
        grid-template-columns: 1fr;
    }
}

.file-list.grid-view .file-item {
    margin-bottom: 0;
    min-width: 0;
    /* Prevent grid item overflow */
}

.file-list.grid-view .file-item:hover {
    transform: translateY(-4px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.file-list.grid-view .file-link {
    display: flex;
    flex-direction: column;
    height: 100%;
    min-height: 150px;
}

.file-list.grid-view .file-main {
    flex-grow: 1;
}

.file-list.grid-view .file-title {
    font-size: 1.1rem;
    margin-bottom: 8px;
}

.file-list.grid-view .tag-list {
    margin-top: auto;
    padding-top: 8px;
}

.file-link:hover {
    text-decoration: none;
}

.file-meta {
    display: block;
    font-size: 0.85rem;
    color: var(--text-muted);
    margin-top: 4px;
}

/* Markdown Content (View) */
.markdown-body {
    background-color: transparent;
    color: var(--text-normal);
    padding: 20px 0;
}

/* Custom Headings */
.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
    margin-top: 24px;
    margin-bottom: 16px;
    font-weight: 600;
    line-height: 1.25;
}

/* H1: Centered, Red/Brown */
.markdown-body h1 {
    font-size: 2.2em;
    color: #8B4513;
    /* SaddleBrown */
    text-align: center;
    border-bottom: none;
    padding-bottom: 0;
    margin-bottom: 30px;
}

/* H2: Orange/Brown with underline */
.markdown-body h2 {
    font-size: 1.8em;
    color: #D2691E;
    /* Chocolate */
    border-bottom: 2px solid #D2691E;
    padding-bottom: 4px;
}

/* H3: Yellow/Gold with underline */
.markdown-body h3 {
    font-size: 1.4em;
    color: #E6B422;
    /* Gold/Yellow */
    border-bottom: 2px solid #E6B422;
    padding-bottom: 4px;
    width: fit-content;
    padding-right: 10px;
    border-radius: 0;
    background-color: transparent;
}

/* H4: Blue with underline */
.markdown-body h4 {
    font-size: 1.2em;
    color: #1976D2;
    /* Blue */
    border-bottom: 2px solid #1976D2;
    padding-bottom: 4px;
    width: fit-content;
    padding-right: 10px;
    /* decorative */
}

/* H5: Purple */
.markdown-body h5 {
    font-size: 1.1em;
    color: #7B1FA2;
    /* Purple */
}

/* H6: Dark Green Uppercase */
.markdown-body h6 {
    font-size: 1em;
    color: #33691E;
    /* Dark Green */
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.markdown-body p {
    margin-top: 0;
    margin-bottom: 16px;
}

.markdown-body code {
    background-color: rgba(135, 131, 120, 0.15);
    padding: 0.2em 0.4em;
    border-radius: 3px;
    font-family: var(--code-font);
    font-size: 85%;
}

.markdown-body hr {
    height: 1px;
    padding: 0;
    margin: 48px 0;
    background-color: var(--border-color);
    border: 0;
}

.markdown-body pre {
    background-color: var(--bg-secondary);
    padding: 16px;
    overflow: auto;
    border-radius: 6px;
    margin-bottom: 16px;
}

.markdown-body pre code {
    background-color: transparent;
    padding: 0;
    font-size: 100%;
}

.markdown-body img {
    max-width: 100%;
    box-sizing: content-box;
    background-color: #fff;
    /* In case of transparent PNGs on dark bg */
}

.markdown-body blockquote {
    margin: 0;
    padding: 0 1em;
    color: var(--text-muted);
    border-left: 0.25em solid var(--border-color);
}

.markdown-body table {
    border-spacing: 0;
    border-collapse: collapse;
    margin-bottom: 16px;
    width: 100%;
}

.markdown-body table th,
.markdown-body table td {
    padding: 6px 13px;
    border: 1px solid var(--border-color);
}

.markdown-body table tr {
    background-color: var(--bg-primary);
    border-top: 1px solid var(--border-color);
}

.markdown-body table tr:nth-child(2n) {
    background-color: var(--bg-secondary);
}

/* Footer */
footer {
    text-align: center;
    padding: 40px 0;
    color: var(--text-muted);
    font-size: 0.9rem;
    border-top: 1px solid var(--border-color);
    margin-top: 40px;
}

/* Link Card */
.link-card {
    display: flex;
    flex-direction: row;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    overflow: hidden;
    text-decoration: none;
    color: inherit;
    margin: 16px 0;
    transition: transform 0.2s, border-color 0.2s;
    background-color: var(--bg-secondary);
    height: 120px;
}

.link-card:hover {
    transform: translateY(-2px);
    border-color: var(--accent-purple);
    text-decoration: none;
}

.link-card-content {
    flex: 1;
    padding: 12px 16px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    overflow: hidden;
    min-width: 0;
}

.link-card-title {
    font-weight: bold;
    font-size: 1rem;
    margin-bottom: 4px;
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
    color: var(--text-normal);
}

/* Mermaid Diagrams */
.mermaid {
    text-align: center;
    margin: 20px 0;
    padding: 20px;
    background-color: var(--bg-secondary);
    border-radius: 8px;
    border: 1px solid var(--border-color);
}

.mermaid svg {
    max-width: 100%;
    height: auto;
}

/* Task List Checkboxes */
.task-list-item {
    list-style: none;
    position: relative;
}

.task-list-item-checkbox {
    margin-right: 8px;
    cursor: not-allowed;
    width: 16px;
    height: 16px;
    vertical-align: middle;
}

.task-list-item-checkbox:checked {
    accent-color: var(--accent-purple);
}

.link-card-description {
    font-size: 0.85rem;
    color: var(--text-muted);
    overflow: hidden;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    line-clamp: 2;
    -webkit-box-orient: vertical;
    margin-bottom: auto;
    line-height: 1.4;
}

.link-card-meta {
    display: flex;
    align-items: center;
    font-size: 0.75rem;
    color: var(--text-muted);
    margin-top: 8px;
}

.link-card-favicon {
    width: 16px;
    height: 16px;
    margin-right: 8px;
    object-fit: contain;
}

.link-card-image {
    width: 300px;
    height: 120px;
    background-size: cover;
    background-position: center;
    flex-shrink: 0;
    order: -1;
}

@media (max-width: 600px) {
    .link-card {
        flex-direction: column-reverse;
        height: auto;
    }

    .link-card-image {
        width: 100%;
        height: 150px;
    }
}

/* Highlights */
mark {
    background-color: rgba(255, 255, 0, 0.4);
    /* Highlight color */
    color: var(--text-normal);
    border-radius: 2px;
    padding: 0 2px;
}

/* Callouts / Admonitions */
.callout {
    overflow: hidden;
    margin: 1em 0;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.12), inset 0 0 2px rgba(0, 0, 0, 0.1);
    border-radius: 4px;
    background-color: var(--bg-secondary);
    border-left: 4px solid var(--accent-purple);
}

.callout-title {
    padding: 0.6em 1em;
    font-weight: bold;
    background-color: rgba(255, 255, 255, 0.05);
    display: flex;
    align-items: center;
    line-height: 1.2;
}

.callout-icon {
    margin-right: 0.5em;
    display: flex;
    align-items: center;
}

.callout-icon svg {
    width: 18px;
    height: 18px;
    fill: currentColor;
}

.callout-content {
    padding: 0.6em 1em;
}

.callout-content p {
    margin: 0.5em 0;
}

.callout-content p:first-child {
    margin-top: 0;
}

.callout-content p:last-child {
    margin-bottom: 0;
}

/* Specific Callout Types */
/* Note (Default) */
.callout-note {
    border-color: #483699;
    background-color: rgba(72, 54, 153, 0.1);
}

.callout-note .callout-title {
    color: #8a75e3;
    background-color: rgba(72, 54, 153, 0.2);
}

/* Tip */
.callout-tip {
    border-color: #00897b;
    background-color: rgba(0, 137, 123, 0.1);
}

.callout-tip .callout-title {
    color: #4db6ac;
    background-color: rgba(0, 137, 123, 0.2);
}

/* Warning */
.callout-warning {
    border-color: #ec7500;
    background-color: rgba(236, 117, 0, 0.1);
}

.callout-warning .callout-title {
    color: #ffb74d;
    background-color: rgba(236, 117, 0, 0.2);
}

/* Error / Danger */
.callout-error,
.callout-danger,
.callout-fail {
    border-color: #e93147;
    background-color: rgba(233, 49, 71, 0.1);
}

.callout-error .callout-title,
.callout-danger .callout-title {
    color: #ef5350;
    background-color: rgba(233, 49, 71, 0.2);
}

/* Success */
.callout-success,
.callout-done,
.callout-check {
    border-color: #00897b;
    /* Greenish */
    background-color: rgba(0, 137, 123, 0.1);
}

.callout-success .callout-title {
    color: #4db6ac;
    background-color: rgba(0, 137, 123, 0.2);
}

/* Info callout - blue/teal theme */
.callout-info {
    border-color: #00b8d4;
    background-color: rgba(0, 184, 212, 0.1);
}

.callout-info .callout-title {
    color: #4dd0e1;
    background-color: rgba(0, 184, 212, 0.2);
}

/* Important callout - yellow theme */
.callout-important {
    border-color: #ffa726;
    background-color: rgba(255, 167, 38, 0.1);
}

.callout-important .callout-title {
    color: #ffb74d;
    background-color: rgba(255, 167, 38, 0.2);
}

/* Question callout - green theme */
.callout-question {
    border-color: #66bb6a;
    background-color: rgba(102, 187, 106, 0.1);
}

.callout-question .callout-title {
    color: #81c784;
    background-color: rgba(102, 187, 106, 0.2);
}

/* Search Accordion */
.search-accordion {
    background-color: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 6px;
    margin-bottom: 20px;
    overflow: hidden;
}

.search-summary {
    list-style: none;
    /* Hide default triangle */
    padding: 0;
    cursor: pointer;
    background-color: var(--bg-secondary);
}

.search-summary::-webkit-details-marker {
    display: none;
}

.search-form {
    display: flex;
    flex-direction: column;
    padding: 15px;
}

.search-input-wrapper {
    display: flex;
    gap: 10px;
    width: 100%;
}

.search-input {
    flex: 1;
    padding: 10px 14px;
    border-radius: 4px;
    border: 1px solid var(--border-color);
    background-color: var(--bg-primary);
    color: var(--text-normal);
    font-family: var(--font-family);
    font-size: 1rem;
}

.search-input:focus {
    outline: none;
    border-color: var(--accent-purple);
}

.search-button {
    padding: 0 16px;
    background-color: var(--accent-purple);
    border: none;
    border-radius: 4px;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
}

.search-button:hover {
    opacity: 0.9;
}

.accordion-hint {
    margin-top: 10px;
    font-size: 0.85rem;
    color: var(--text-muted);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 5px;
    user-select: none;
}

.accordion-icon {
    font-size: 0.8rem;
    transition: transform 0.2s;
}

details[open] .accordion-icon {
    transform: rotate(180deg);
}

.tag-cloud {
    padding: 0 15px 15px;
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    border-top: 1px solid var(--border-color);
    margin-top: 5px;
    padding-top: 15px;
}

.tag-chip {
    padding: 4px 10px;
    background-color: var(--bg-primary);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    color: var(--text-muted);
    font-size: 0.85rem;
    transition: all 0.2s;
    text-decoration: none;
}

.tag-chip:hover {
    border-color: var(--accent-purple);
    color: var(--text-normal);
    text-decoration: none;
}

.tag-chip.active {
    background-color: rgba(123, 97, 255, 0.2);
    border-color: var(--accent-purple);
    color: var(--accent-purple);
}

/* Updated File List */
.file-main {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 10px;
}

.file-tags {
    display: flex;
    gap: 6px;
}

.file-tag {
    font-size: 0.75rem;
    color: var(--text-muted);
    background-color: rgba(255, 255, 255, 0.05);
    padding: 2px 6px;
    border-radius: 4px;
}

/* File Meta Information */
.file-meta {
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
    margin-top: 8px;
    font-size: 0.8rem;
    color: var(--text-muted);
}

.file-path {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    margin-right: 10px;
}

.file-updated {
    white-space: nowrap;
    font-feature-settings: "tnum";
    font-variant-numeric: tabular-nums;
}

.empty-state {
    padding: 30px;
    text-align: center;
    color: var(--text-muted);
    font-style: italic;
}

/* Pagination */
.pagination {
    display: flex;
    justify-content: center;
    align-items: center;
    margin-top: 30px;
    gap: 10px;
}

.page-link {
    padding: 8px 16px;
    background-color: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    color: var(--text-normal);
    font-size: 0.9rem;
    transition: all 0.2s;
}

.page-link:hover:not(.disabled) {
    border-color: var(--accent-purple);
    text-decoration: none;
}

.page-link.disabled {
    opacity: 0.5;
    cursor: not-allowed;
    background-color: transparent;
}

.page-info {
    color: var(--text-muted);
    font-size: 0.9rem;
    margin: 0 10px;
}

/* Tables */
.markdown-body table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    margin: 20px 0;
    background-color: var(--bg-secondary);
    border-radius: 8px;
    overflow: hidden;
    border: 1px solid var(--border-color);
}

.markdown-body table thead {
    background-color: var(--accent-purple) !important;
}

.markdown-body table thead th {
    padding: 12px 16px;
    text-align: left;
    font-weight: 600;
    color: white !important;
    background-color: var(--accent-purple) !important;
    border-bottom: 2px solid rgba(255, 255, 255, 0.2);
}

.markdown-body table tbody tr {
    border-bottom: 1px solid var(--border-color);
    transition: background-color 0.2s ease;
}

.markdown-body table tbody tr:hover {
    background-color: rgba(123, 97, 255, 0.1);
}

.markdown-body table tbody tr:last-child {
    border-bottom: none;
}

.markdown-body table td {
    padding: 10px 16px;
    color: var(--text-normal);
}

.markdown-body table th {
    font-weight: 600;
}

/* Table Copy Functionality */
.table-wrapper {
    position: relative;
    margin: 20px 0;
}

.table-copy-container {
    position: absolute;
    top: 8px;
    right: 8px;
    z-index: 10;
}

.table-copy-btn {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    background-color: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 6px;
    color: var(--text-normal);
    cursor: pointer;
    font-size: 0.85rem;
    transition: all 0.2s;
}

.table-copy-btn:hover {
    background-color: var(--bg-primary);
    border-color: var(--accent-purple);
}

.table-copy-btn svg {
    width: 16px;
    height: 16px;
}

.table-copy-dropdown {
    position: absolute;
    top: 100%;
    right: 0;
    margin-top: 4px;
    background-color: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 6px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    display: none;
    flex-direction: column;
    min-width: 180px;
    overflow: hidden;
}

.table-copy-dropdown.show {
    display: flex;
}

.copy-option {
    padding: 10px 14px;
    background: none;
    border: none;
    color: var(--text-normal);
    cursor: pointer;
    text-align: left;
    font-size: 0.9rem;
    transition: background-color 0.2s;
}

.copy-option:hover {
    background-color: rgba(123, 97, 255, 0.1);
}

.copy-option:not(:last-child) {
    border-bottom: 1px solid var(--border-color);
}

/* Page Menu (Three-dot menu) */
.page-menu-container {
    position: relative;
}

.page-menu-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
    padding: 8px;
    background-color: transparent;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    color: var(--text-normal);
    cursor: pointer;
    transition: all 0.2s;
}

.page-menu-btn:hover {
    background-color: var(--bg-secondary);
    border-color: var(--accent-purple);
}

.page-menu-dropdown {
    position: absolute;
    top: 100%;
    right: 0;
    margin-top: 8px;
    background-color: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 6px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    display: none;
    flex-direction: column;
    min-width: 160px;
    overflow: hidden;
    z-index: 100;
}

.page-menu-dropdown.show {
    display: flex;
}

.menu-option {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 12px 16px;
    background: none;
    border: none;
    color: var(--text-normal);
    cursor: pointer;
    text-align: left;
    font-size: 0.9rem;
    transition: background-color 0.2s;
}

.menu-option:hover {
    background-color: rgba(123, 97, 255, 0.1);
}

.menu-option svg {
    width: 16px;
    height: 16px;
}

/* Scroll to Top Button */
.scroll-to-top {
    position: fixed;
    bottom: 24px;
    right: 24px;
    width: 52px;
    height: 52px;
    background: linear-gradient(135deg, var(--accent-purple), #9575ff);
    border: none;
    border-radius: 50%;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(123, 97, 255, 0.3);
    opacity: 0;
    visibility: hidden;
    transform: translateY(20px);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 1000;
}

.scroll-to-top.show {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}

.scroll-to-top:hover {
    transform: translateY(-4px) scale(1.05);
    box-shadow: 0 6px 20px rgba(123, 97, 255, 0.4);
}

.scroll-to-top:active {
    transform: translateY(-2px) scale(1.02);
}

.scroll-to-top svg {
    width: 24px;
    height: 24px;
}

/* Page settings for PDF Export */
@page {
    margin: 0.5cm;
    size: A4;
}

/* Print Styles for PDF Export */
@media print {

    /* Hide UI elements */
    header,
    footer,
    .breadcrumb,
    .page-menu-container,
    .table-copy-container,
    .theme-toggle-btn,
    .search-container,
    .scroll-to-top {
        display: none !important;
    }

    /* Dark theme print styles */
    :root[data-theme="dark"] body {
        background-color: #1e1e1e !important;
        color: #dcddde !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
    }

    :root[data-theme="dark"] .markdown-body {
        background-color: #1e1e1e !important;
        color: #dcddde !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
    }

    :root[data-theme="dark"] pre,
    :root[data-theme="dark"] code {
        background-color: #252526 !important;
        color: #dcddde !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
    }

    /* Light theme print styles */
    :root[data-theme="light"] body {
        background-color: white !important;
        color: #2e3338 !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
    }

    :root[data-theme="light"] .markdown-body {
        background-color: white !important;
        color: #2e3338 !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
    }

    :root[data-theme="light"] pre,
    :root[data-theme="light"] code {
        background-color: #f5f5f5 !important;
        color: #2e3338 !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
    }

    /* Common print styles */
    .markdown-body {
        max-width: 100%;
        padding: 20px;
    }

    .container,
    .container-wide {
        max-width: 100% !important;
        padding: 0 !important;
        margin: 0 !important;
    }

    /* Ensure table styles work in print */
    .markdown-body table {
        page-break-inside: avoid;
        border-collapse: collapse;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
    }

    .markdown-body table thead {
        background-color: #7b61ff !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
    }

    .markdown-body table thead th {
        color: white !important;
        background-color: #7b61ff !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
    }

    /* Page breaks */
    h1,
    h2,
    h3 {
        page-break-after: avoid;
    }

    /* Preserve code block styling */
    pre {
        page-break-inside: avoid;
    }
}

/* Light Theme Overrides for File List */
:root[data-theme="light"] .file-item {
    background-color: rgba(255, 255, 255, 0.6);
    border-color: rgba(123, 97, 255, 0.3);
    box-shadow: 0 0 12px rgba(123, 97, 255, 0.15);
}

:root[data-theme="light"] .file-item:hover {
    border-color: rgba(123, 97, 255, 0.5);
    box-shadow: 0 0 25px rgba(123, 97, 255, 0.3), 0 4px 12px rgba(0, 0, 0, 0.1);
}

:root[data-theme="light"] .file-preview {
    background: linear-gradient(to bottom right, #a89ff5, #c4b5fd, #d4c5ff);
    border: 1px solid rgba(123, 97, 255, 0.4);
    box-shadow: 0 0 25px rgba(123, 97, 255, 0.25), inset 0 0 25px rgba(255, 255, 255, 0.5);
}

:root[data-theme="light"] .file-preview p {
    color: #3d2a7f;
    text-shadow: none;
}

:root[data-theme="light"] .file-tag {
    background: linear-gradient(135deg, #7b61ff, #9575ff);
    color: white;
    border-color: rgba(123, 97, 255, 0.6);
    box-shadow: 0 0 12px rgba(123, 97, 255, 0.4), inset 0 0 8px rgba(255, 255, 255, 0.3);
}

:root[data-theme="light"] .file-tag:hover {
    box-shadow: 0 0 18px rgba(123, 97, 255, 0.6), inset 0 0 12px rgba(255, 255, 255, 0.35);
}

:root[data-theme="light"] .file-list.grid-view .file-preview {
    box-shadow: 0 0 30px rgba(123, 97, 255, 0.3), inset 0 0 25px rgba(255, 255, 255, 0.5);
}

/* Dark Mode Tag Styles */
:root[data-theme="dark"] .file-tag {
    color: white !important;
}

/* Mobile Search Toggle */
.mobile-search-btn {
    background: transparent;
    border: 1px solid var(--border-color);
    padding: 8px;
    border-radius: 6px;
    color: var(--text-normal);
    cursor: pointer;
    transition: all 0.2s;
    display: none;
    /* Hidden on desktop */
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
}

.mobile-search-btn:hover {
    background-color: var(--bg-primary);
    border-color: var(--accent-purple);
}

/* Modal Search Styles */
.search-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8);
    z-index: 2000;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    padding-top: 80px;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
    backdrop-filter: blur(5px);
}

.search-modal.active {
    opacity: 1;
    visibility: visible;
}

.search-modal-content {
    width: 90%;
    max-width: 600px;
    background-color: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    transform: translateY(-20px);
    transition: transform 0.3s ease;
}

.search-modal.active .search-modal-content {
    transform: translateY(0);
}

.search-modal-header {
    display: flex;
    align-items: center;
    padding: 16px;
    border-bottom: 1px solid var(--border-color);
    gap: 12px;
}

.search-icon-modal {
    color: var(--text-muted);
}

#modal-search-input {
    flex: 1;
    background: transparent;
    border: none;
    color: var(--text-normal);
    font-size: 1.1rem;
    font-family: var(--font-family);
    outline: none;
}

.close-modal-btn {
    background: transparent;
    border: none;
    color: var(--text-muted);
    cursor: pointer;
    padding: 4px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.2s, color 0.2s;
}

.close-modal-btn:hover {
    background-color: rgba(255, 255, 255, 0.1);
    color: var(--text-normal);
}

.search-modal-results {
    max-height: 60vh;
    overflow-y: auto;
    padding: 8px 0;
}

.search-modal-results .search-result-item {
    padding: 12px 16px;
}

/* Responsive Adjustments */
@media (max-width: 768px) {
    .function-search-container {
        display: none !important;
    }

    .mobile-search-btn {
        display: flex;
    }

    .header-actions {
        gap: 8px;
    }

    .brand-text {
        font-size: 0.9rem;
    }

    .brand-logo {
        width: 32px;
        height: 32px;
    }
}

/* Mobile List View Adjustments */
@media (max-width: 600px) {
    .file-list:not(.grid-view) .file-link {
        flex-direction: column;
        height: auto;
        min-height: auto;
    }

    .file-list:not(.grid-view) .file-preview {
        width: 100%;
        height: 160px;
        margin-bottom: 8px;
    }

    .file-list:not(.grid-view) .file-content {
        width: 100%;
    }
}

/* Sidebar & Layout Styles */
/* Sidebar & Layout Styles */
.app-wrapper {
    display: flex;
    min-height: 100vh;
    position: relative;
    max-width: 100%;
    margin: 0 auto;
    padding-top: 60px;
    /* Prevent header overlap */
    /* Desktop: Shift content when sidebar is open */
    margin-left: 330px;
    transition: margin-left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Header Adjustments for Desktop */
header {
    position: fixed;
    top: 0;
    right: 0;
    /* Header toggles with sidebar */
    left: 330px;
    /* 50px Activity Bar + 280px Sidebar */
    width: calc(100% - 330px);
    height: 60px;
    z-index: 1000;
    /* Standard z-index */
    transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1), width 0.3s cubic-bezier(0.4, 0, 0.2, 1);

    /* Ensure header content is aligned */
    padding-left: 0;
}

.sidebar {
    width: 280px;
    background-color: #252526;
    /* Solid opaque color */
    border-right: 1px solid rgba(255, 255, 255, 0.1);
    flex-shrink: 0;
    height: 100vh;
    /* Full height */
    position: fixed;
    top: 0;
    left: 50px;
    /* Offset by Activity Bar */
    overflow-y: auto;
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 1100;
    /* Above content, below header */

    /* Remove Overlay Effects */
    box-shadow: none;
    backdrop-filter: none;
    -webkit-backdrop-filter: none;

    padding-top: 0;
    display: flex;
    flex-direction: column;
}

/* Brand Logo Spacing (in Header) */
.brand {
    margin-left: 0;
    display: flex;
    align-items: center;
    gap: 10px;
    text-decoration: none;
    color: var(--text-normal);
    padding-left: 12px;
    /* Add padding inside header */
}

/* Collapsed State: Reset Layout */
html.sidebar-collapsed .app-wrapper {
    margin-left: 50px;
}

html.sidebar-collapsed header {
    left: 50px;
    width: calc(100% - 50px);
}

[data-theme="light"] .sidebar {
    background-color: #f3f3f3;
    /* Solid light color */
    border-right: 1px solid rgba(0, 0, 0, 0.05);
}

/* Scrollbar for sidebar */
.sidebar::-webkit-scrollbar {
    width: 6px;
}

.sidebar::-webkit-scrollbar-thumb {
    background-color: var(--border-color);
    border-radius: 3px;
}

.sidebar-content {
    padding: 16px;
}

.file-tree {
    font-size: 0.9rem;
}

.tree-list {
    list-style: none;
    padding-left: 0;
    margin: 0;
}

.tree-list .tree-list {
    padding-left: 16px;
    margin-top: 4px;
    border-left: 1px solid var(--border-color);
}

.tree-item {
    margin-bottom: 4px;
}

.tree-folder,
.tree-file {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 6px 8px;
    border-radius: 6px;
    cursor: pointer;
    color: var(--text-muted);
    transition: background-color 0.2s, color 0.2s;
    text-decoration: none;
    user-select: none;
}

.tree-folder:hover,
.tree-file:hover {
    background-color: rgba(255, 255, 255, 0.05);
    /* Light hover mainly for dark mode */
    color: var(--text-normal);
}

[data-theme="light"] .tree-folder:hover,
[data-theme="light"] .tree-file:hover {
    background-color: rgba(0, 0, 0, 0.05);
}

.tree-file.active {
    background: linear-gradient(90deg, rgba(89, 64, 196, 0.1), transparent);
    color: #8366e6;
    /* Accent color */
    border-left: 3px solid #8366e6;
}

.tree-folder {
    font-weight: 500;
}

details>summary {
    list-style: none;
}

details>summary::-webkit-details-marker {
    display: none;
}

/* Container adjustment for sidebar */
.container {
    flex-grow: 1;
    padding: 20px;
    max-width: 100%;
    /* Override previous max-width */
    margin: 0;
    /* Removing auto margin */
    width: 0;
    /* Flexbox trick for min-width overflow */
}

/* Activity Bar (Ribbon) */
.activity-bar {
    position: fixed;
    top: 0;
    left: 0;
    width: 50px;
    height: 100vh;
    background-color: #1e1e1e;
    /* Darker than sidebar */
    border-right: 1px solid rgba(255, 255, 255, 0.1);
    z-index: 2000;
    /* Topmost */
    display: flex;
    flex-direction: column;
    align-items: center;
    padding-top: 12px;
}

[data-theme="light"] .activity-bar {
    background-color: #f0f0f0;
    border-right: 1px solid rgba(0, 0, 0, 0.1);
}

/* Header adjustments */
.header-left {
    display: flex;
    align-items: center;
    gap: 12px;
    padding-left: 0;
}



/* Toggle Buttons */
.sidebar-toggle-btn {
    background: transparent;
    border: none;
    color: var(--text-normal);
    cursor: pointer;
    padding: 8px;
    /* Revert to standard padding */
    border-radius: 6px;
    display: flex;
    transition: background-color 0.2s, color 0.2s;
    margin: 0;
    /* Remove extra margin */
}

.sidebar-toggle-btn:hover {
    background-color: rgba(255, 255, 255, 0.1);
}

[data-theme="light"] .sidebar-toggle-btn:hover {
    background-color: rgba(0, 0, 0, 0.05);
}

/* Desktop Toggle (inside Activity Bar) */
.desktop-toggle {
    display: flex;
}

/* Mobile Toggle (inside Header) */
.mobile-toggle {
    display: none;
    /* Hidden on Desktop */
}

/* Fixed Toggle Button */


.sidebar-toggle-btn:hover {
    background-color: rgba(255, 255, 255, 0.1);
}

[data-theme="light"] .sidebar-toggle-btn:hover {
    background-color: rgba(0, 0, 0, 0.05);
}





/* When sidebar occupies the left, the button sits on top of it.
   When sidebar is closed, button sits on top of collapsed content/white space.
   We need to ensure it's visible in both themes.
*/

/* Sidebar Overlay */
.sidebar-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 90;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s;
    backdrop-filter: blur(2px);
}

/* Mobile Overrides */
@media (max-width: 768px) {

    /* Hide Activity Bar */
    .activity-bar {
        display: none;
    }

    /* Toggle Buttons */
    .desktop-toggle {
        display: none;
    }

    .mobile-toggle {
        display: flex;
        margin-right: 12px;
    }

    /* On mobile, sidebar is absolute/fixed, so collapsed state logic is different (handled by transform) */
    .sidebar {
        position: fixed;
        top: 0;
        left: 0;
        height: 100vh;
        width: 280px !important;
        /* Force width */
        transform: translateX(-100%);
        box-shadow: 2px 0 10px rgba(0, 0, 0, 0.3);
        z-index: 1100;
        /* Above header (z-index: 1000) on mobile */
        border-right: none;
        visibility: visible !important;
        /* Always visible for transition */
    }

    /* However, 'sidebar-hidden' (from index view) should still HIDE it or let it be toggled?
       On mobile, the sidebar is hidden by default (via transform). 
       The 'sidebar-hidden' class on index.html removes it from DOM/Layout entirely.
       If we want it totally gone on mobile index page too, display: none is fine.
     */

    .sidebar.active {
        transform: translateX(0);
    }

    .sidebar-overlay.active {
        opacity: 1;
        visibility: visible;
    }

    .sidebar-toggle-btn {
        display: flex;
    }

    .brand-logo {
        margin-right: 0;
    }

    /* Adjust app wrapper for mobile */
    .app-wrapper {
        display: block;
        margin-left: 0 !important;
        /* No shift on mobile */
        margin-top: 60px;
        /* Offset for fixed header */
        min-height: calc(100vh - 60px);
    }

    header {
        left: 0 !important;
        width: 100% !important;
        background-color: var(--bg-secondary);
        /* Ensure opaque header on mobile */
    }

    .container {
        width: 100%;
        padding: 16px;
    }

    /* Mobile Sidebar: Outline Only */
    .sidebar-tabs {
        display: none !important;
    }

    #sidebar-files {
        display: none !important;
    }

    #sidebar-outline.sidebar-panel {
        display: block !important;
    }
}

/* Link Preview Tooltip */
.preview-tooltip {
    position: absolute;
    width: 400px;
    max-width: 90vw;
    max-height: 300px;
    background-color: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
    z-index: 1000;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease;
}

.preview-tooltip.active {
    opacity: 1;
    pointer-events: auto;
}

.preview-header {
    padding: 10px 16px;
    background-color: rgba(0, 0, 0, 0.2);
    border-bottom: 1px solid var(--border-color);
    font-weight: 600;
    font-size: 0.9rem;
    color: var(--text-normal);
}

.preview-content {
    padding: 16px;
    overflow-y: auto;
    font-size: 0.85rem;
    line-height: 1.5;
    color: var(--text-normal);
}

.preview-content :first-child {
    margin-top: 0;
}

/* Loading & Error States */
.preview-loading,
.preview-error {
    padding: 20px;
    text-align: center;
    color: var(--text-muted);
    font-style: italic;
}

.preview-error {
    color: #ff6b6b;
}

/* Light Theme Adjustments */
[data-theme="light"] .preview-header {
    background-color: rgba(0, 0, 0, 0.05);
}

/* =========================================
   Sidebar Enhancements (Tabs, TOC, Toggle)
   ========================================= */

/* Sidebar Tabs Container */
.sidebar-tabs {
    display: flex;
    background-color: transparent;
    padding: 8px 8px 0;
    gap: 8px;
    position: sticky;
    top: 0;
    z-index: 10;
}

/* Tab Button (Modern) */
.sidebar-tab {
    flex: 1;
    background: transparent;
    border: none;
    padding: 8px;
    color: var(--text-muted);
    cursor: pointer;
    font-size: 0.85rem;
    font-weight: 600;
    transition: all 0.2s;
    border-radius: 8px;
    text-align: center;
    border-bottom: none;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    /* Space between icon and text */
}

.sidebar-tab svg {
    opacity: 0.7;
    transition: opacity 0.2s;
}

.sidebar-tab:hover {
    color: var(--text-normal);
    background-color: rgba(255, 255, 255, 0.05);
}

.sidebar-tab:hover svg {
    opacity: 1;
}

[data-theme="light"] .sidebar-tab:hover {
    background-color: rgba(0, 0, 0, 0.05);
}

.sidebar-tab.active {
    color: white;
    background-color: var(--accent-purple);
    box-shadow: 0 4px 12px rgba(123, 97, 255, 0.3);
}

.sidebar-tab.active svg {
    opacity: 1;
}

/* Sidebar Panels (Tab Content) */
.sidebar-panel {
    display: none;
    padding-top: 10px;
}

.sidebar-panel.active {
    display: block;
    animation: fadeIn 0.2s ease;
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

/* TOC (Table of Contents) Tree Styles */
.toc-tree,
.toc-sublist {
    list-style: none;
    padding: 0;
    margin: 0;
}

.toc-tree {
    padding-left: 8px;
}

.toc-sublist {
    padding-left: 20px;
    /* Indent for children */
    border-left: 1px solid #3d3d3d;
    /* Guide line */
    margin-left: 9px;
    /* Align guide line with parent icon center approximately */
}

.toc-item-wrapper {
    position: relative;
}

.toc-item {
    display: flex;
    align-items: center;
    padding: 6px 8px;
    color: var(--text-muted);
    font-size: 0.85rem;
    border-radius: 4px;
    transition: all 0.2s;
    cursor: pointer;
    line-height: 1.4;
    user-select: none;
    margin-bottom: 2px;
    gap: 8px;
}

.toc-item:hover {
    color: var(--text-normal);
    background-color: rgba(255, 255, 255, 0.05);
}

.toc-item.active {
    color: #a390ff;
    /* Light purple active text */
    background-color: rgba(123, 97, 255, 0.1);
}

/* Icons */
.toc-icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 20px;
    font-weight: bold;
    flex-shrink: 0;
}

.type-header {
    color: #a390ff;
    /* Purple color for 'H' icon */
}

.type-item {
    color: #5c87ff;
    /* Blue diamond */
    font-size: 10px;
}

.toc-text {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* Hover/Active states matching purple theme */
.toc-item.active .toc-text {
    color: #9d86ff;
    /* Purple active text */
}

/* Indentation adjustments are handled by nesting ULs */

.toc-empty {
    padding: 20px;
    text-align: center;
    color: var(--text-muted);
    font-style: italic;
    font-size: 0.9rem;
}



/* Desktop Sidebar Collapsed State */
/* When collapsed, we hide the sidebar content but keep the element to animate width */
/* Desktop Sidebar Collapsed State */
/* Slide off-screen using transform for smooth overlay animation */
html.sidebar-collapsed .sidebar {
    transform: translateX(-100%);
    visibility: visible;
    /* Keep visible for transition, but off-screen */
}

/* Ensure main content expands */
/* Ensure main content expands */
.container {
    /* Transitions handled by app-wrapper and header */
}

/* Sidebar Hidden Utility (for Index View) */
.sidebar-hidden {
    display: none !important;
}

/* Mobile Overrides */
@media (max-width: 768px) {

    /* On mobile, sidebar is absolute/fixed, so collapsed state logic is different (handled by transform) */
    .sidebar {
        width: 280px !important;
        /* Force width */
        visibility: visible !important;
        /* Always visible for transition */
    }

    /* However, 'sidebar-hidden' (from index view) should still HIDE it or let it be toggled?
       On mobile, the sidebar is hidden by default (via transform). 
       The 'sidebar-hidden' class on index.html removes it from DOM/Layout entirely.
       If we want it totally gone on mobile index page too, display: none is fine.
    */
}

/* Obsidian Image Styling */
.obsidian-image {
    margin: 1.5rem 0;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15),
        0 2px 4px rgba(0, 0, 0, 0.1);
    border-radius: 4px;
    max-width: 100%;
    height: auto;
    display: block;
    transition: box-shadow 0.3s ease, transform 0.3s ease;
}

.obsidian-image:hover {
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2),
        0 4px 8px rgba(0, 0, 0, 0.15);
    transform: translateY(-2px);
}

/* Light theme adjustments */
:root[data-theme="light"] .obsidian-image {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08),
        0 2px 4px rgba(0, 0, 0, 0.05);
}

/* Tag Filter Accordion */
.search-accordion {
    border: 1px solid var(--border-color);
    border-radius: 6px;
    background-color: var(--bg-secondary);
    margin-bottom: 20px;
    overflow: hidden;
}

.search-summary {
    list-style: none;
    cursor: pointer;
    padding: 0;
    margin: 0;
}

.search-summary::-webkit-details-marker {
    display: none;
}

/* Ensure search form looks good inside summary */
.search-form {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px 15px;
    width: 100%;
}

.search-input-wrapper {
    flex-grow: 1;
    display: flex;
    align-items: center;
    margin-right: 15px;
    position: relative;
}

.search-button {
    background: none;
    border: none;
    color: var(--text-muted);
    cursor: pointer;
    position: absolute;
    right: 8px;
    display: flex;
    /* Fix alignment */
    align-items: center;
}

.accordion-hint {
    display: flex;
    align-items: center;
    gap: 8px;
    color: var(--text-muted);
    font-size: 0.9em;
    user-select: none;
    white-space: nowrap;
}

.accordion-icon {
    transition: transform 0.3s ease;
    width: 16px;
    height: 16px;
}

details[open] .accordion-icon {
    transform: rotate(180deg);
}

.tag-filter-container {
    border-top: 1px solid var(--border-color);
}

.tag-cloud {
    padding: 15px;
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

.tag-chip {
    padding: 4px 10px;
    border-radius: 12px;
    background-color: var(--bg-primary);
    color: var(--text-muted);
    font-size: 0.85em;
    border: 1px solid var(--border-color);
    transition: all 0.2s;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
}

.tag-chip:hover {
    border-color: var(--accent-purple);
    color: var(--text-normal);
    text-decoration: none;
    transform: translateY(-1px);
}

.tag-chip.active {
    background-color: rgba(123, 97, 255, 0.15);
    border-color: var(--accent-purple);
    color: var(--accent-purple);
    font-weight: 600;
}

/* Print Styles */
@media print {

    /* 1. Print Color Adjustment - Essential for Dark Mode Backgrounds */
    html,
    body {
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
        /* Do NOT force white background here, let the theme variable take effect */
        background-color: var(--bg-primary) !important;
        color: var(--text-normal) !important;
        margin: 0 !important;
        padding: 0 !important;
        width: 100% !important;
        height: auto !important;
        overflow: visible !important;
    }

    /* 2. Hide ALL UI elements */
    header,
    footer,
    nav,
    #sidebar,
    .sidebar-overlay,
    .activity-bar,
    .page-menu-container,
    .breadcrumb,
    .view-toggle,
    .index-header-top,
    .search-container,
    .theme-toggle-btn,
    .mobile-search-btn,
    .sidebar-toggle-btn,
    .table-copy-container,
    .copy-button,
    .scroll-to-top,
    .page-menu-dropdown {
        display: none !important;
    }

    /* 3. Main Layout Reset */
    .app-wrapper,
    main {
        display: block !important;
        margin: 0 !important;
        padding: 0 !important;
        width: 100% !important;
        max-width: none !important;
        /* Ensure transparency so body background shows through */
        background-color: transparent !important;
    }

    .container,
    .container-wide {
        width: 100% !important;
        max-width: none !important;
        margin: 0 !important;
        padding: 0 40px !important;
        box-shadow: none !important;
        background-color: transparent !important;
    }

    /* 4. Markdown Body */
    .markdown-body {
        width: 100% !important;
        max-width: none !important;
        padding: 0 !important;
        /* Inherit colors from theme */
        color: var(--text-normal) !important;
        font-size: 11pt;
        background-color: transparent !important;
    }

    /* Headings - Let Theme colors apply */
    .markdown-body h1,
    .markdown-body h2,
    .markdown-body h3,
    .markdown-body h4,
    .markdown-body h5,
    .markdown-body h6 {
        page-break-after: avoid;
        /* Remove color overrides so H1/H2 colors (orange/brown) show up */
    }

    /* Text Elements */
    p,
    ul,
    ol,
    li,
    blockquote {
        color: inherit !important;
    }

    /* Links */
    a {
        text-decoration: underline;
        color: var(--accent-purple) !important;
        /* Keep link color */
    }

    a::after {
        content: "";
        /* Clean links for dark mode usually look better without URLs */
    }

    /* 5. Code Blocks */
    pre {
        /* Use theme colors or specific dark mode override if needed */
        background-color: var(--bg-secondary) !important;
        border: 1px solid var(--border-color) !important;
        white-space: pre-wrap !important;
        page-break-inside: avoid;
    }

    code {
        color: inherit;
        /* Let syntax highlighting work */
        background-color: transparent !important;
        border: none !important;
    }

    /* 6. Tables - Respect Theme */
    .markdown-body table {
        border-collapse: collapse !important;
        width: 100% !important;
        /* Theme colors */
        background-color: var(--bg-secondary) !important;
        color: var(--text-normal) !important;
    }

    .markdown-body table th,
    .markdown-body table td {
        border: 1px solid var(--border-color) !important;
        padding: 8px !important;
        background-color: transparent !important;
        color: inherit !important;
    }

    .markdown-body table th {
        /* Let the theme's default TH style apply (purple header from previous CSS) */
        background-color: var(--accent-purple) !important;
        color: white !important;
        font-weight: bold !important;
    }

    /* Rows alternations handled by main CSS */

    /* 7. Callouts */
    .callout {
        /* Respect main CSS colors */
        box-shadow: none !important;
    }

    /* 8. Images / Diagrams */
    img,
    svg {
        max-width: 100% !important;
        page-break-inside: avoid;
    }

    .mermaid {
        background-color: var(--bg-secondary) !important;
        border: 1px solid var(--border-color) !important;
        /* Invert colors for dark mode mermaid if needed, usually default SVG lines are black so careful here. 
           If the diagram lines are black, they might be invisible on dark bg. 
           Usually Mermaid handles this via theme, or we trust the SVG colors. */
    }
}