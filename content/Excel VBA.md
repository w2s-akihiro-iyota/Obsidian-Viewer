---
tags:
  - Excel
  - VBA
aliases: 
created: 火曜日, 3月 12日 2024, 12:02:45 午後
modified: 火曜日, 3月 12日 2024, 12:06:09 午後
---

## Excel VBA

### ボタンに引数を渡せるらしいぞ！

ボタンにマクロを設定するときに引数を設定することができるらしい、、、
詳しくは下記の記事を確認してほしいが、これは結構便利かも
[エクセルVBAのボタン設置で引数を渡してマクロを呼び出す方法](https://tonari-it.com/excel-vba-button-augument/)

上記で観点テキストの取得を効率化できそう。
今は自作関数で対応しているがこれが重い、、、
なので、ボタン押下で取得するようにしたい。

### 観点テキスト取得の案を雑に記載しておく

- 前テスト観点のテキストを最初にすべて取得しておく
	- 観点項番を Key に、観点テキストを Value で
- 引数として、チェックリストの列文字、観点テキストの列文字を他わせるようにしておく

### ボタンに引数をセットする方法

下記のように、ボタンに引数付きの関数をセットできる

```
Ver3.X.xlsm!'GetPatternTextForButton.TestSub "A","B"'
```

### マクロ登録時のルール

- マクロ名の続きで半角スペースを空けて引数
- 引数が文字列型、日付型の場合は引数をダブルクォーテーションで囲む
- 引数を複数指定したいときはカンマで区切る
- マクロ名と引数全体をシングルクォーテーションで囲む

## 処理速度

単一セルの参照は Cells の方が速い
単一セルを参照するときは Cells 関数、複数の範囲をしているする際は Range 関数で使い分けるといい

### Range(“A” & CStr(iRow)) と書くと遅い

ループして各行の列を参照するときは 'Cells(rowNumber, " 列文字 ")' を利用したほうがいい

## 部分一致と完全一致

Filter 関数は部分一致のため、完全一致には使えない
完全一致の場合は下記が参考になる
[【VBS・VBA共通】配列の要素を完全一致で検索するサンプルプログラム - ITエンジニアの備忘録的技術ブログ【仮】](https://www.depthbomb.net/?p=3111)
